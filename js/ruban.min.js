/**
 * ruban v0.3.2
 *
 * Copyright (c) 2013 Lo√Øc Frering <loic.frering@gmail.com>
 * Distributed under the MIT license
 */
(function(){var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a){this.options=null!=a?a:{},this.next=b(this.next,this),this.last=b(this.last,this),this.prev=b(this.prev,this),this.first=b(this.first,this),this.checkHash=b(this.checkHash,this),this.initOptions(),this.$sections=$("section").wrapAll('<div class="ruban"></div>'),this.$ruban=$(".ruban"),this.toc(),this.current(this.$sections.first()),this.pagination(),this.checkHash(),this.highlight(),this.resize(),this.bind(),this.$ruban.css("transition-property","transform"),this.$ruban.css("-webkit-transition-property","-webkit-transform"),this.$ruban.css("transition-duration",this.options.transitionDuration)}return a.prototype.initOptions=function(){var a,b,c,d,e,f,g,h;return null==(a=this.options).ratio&&(a.ratio=4/3),null==(b=this.options).minPadding&&(b.minPadding="0.4em"),null==(c=this.options).transitionDuration&&(c.transitionDuration="1s"),null==(d=this.options).pagination&&(d.pagination=!1),null==(e=this.options).title&&(e.title=null),null==(f=this.options).stripHtmlInToc&&(f.stripHtmlInToc=!1),null==(g=this.options).bindClicks&&(g.bindClicks=!1),null!=(h=this.options).bindMouseWheel?(h=this.options).bindMouseWheel:h.bindMouseWheel=!1},a.prototype.bind=function(){return this.bindKeys(),this.bindGestures(),this.options.bindClicks&&this.bindClicks(),this.options.bindMouseWheel&&this.bindMouseWheel(),this.bindResize(),this.bindHashChange()},a.prototype.bindKeys=function(){return key("right, down, space, return, j, l, pagedown",this.next),key("left, up, backspace, k, h, pageup",this.prev),key("home",this.first),key("last",this.last)},a.prototype.bindGestures=function(){return Hammer(document,{drag_block_vertical:!0,drag_block_horizontal:!0}).on("swipeleft swipeup",this.next).on("swiperight swipedown",this.prev)},a.prototype.bindClicks=function(){var a=this;return this.$ruban.contextmenu(function(){return!1}),this.$ruban.mousedown(function(b){switch(b.which){case 1:return a.next();case 3:return a.prev()}})},a.prototype.bindMouseWheel=function(){var a=this;return this.$ruban.on("wheel",function(b){return b.originalEvent.deltaY>0?a.next():b.originalEvent.deltaY<0?a.prev():void 0})},a.prototype.bindResize=function(){var a=this;return $(window).resize(function(){return a.resize(),a.go(a.$current,{force:!0})})},a.prototype.bindHashChange=function(){return $(window).on("hashchange",this.checkHash)},a.prototype.disableTransitions=function(){return this.$ruban.css("transition-property","none")},a.prototype.enableTransitions=function(){return this.$ruban.css("transition-property","transform")},a.prototype.resize=function(){var a,b,c,d,e,f,g,h;return h=[$(window).width(),$(window).height()],d=h[0],c=h[1],d>this.options.ratio*c?(b=c,f=this.options.minPadding,this.$ruban.parent().css("font-size",""+.4*b+"%"),this.$sections.css({"padding-top":f,"padding-bottom":f}),a=this.$current.height(),g=this.options.ratio*a,e=""+(d-g)/2+"px",this.$sections.css({"padding-left":e,"padding-right":e})):(b=d/this.options.ratio,e=this.options.minPadding,this.$ruban.parent().css("font-size",""+.4*b+"%"),this.$sections.css({"padding-left":e,"padding-right":e}),g=this.$current.width(),a=g/this.options.ratio,f=""+(c-a)/2+"px",this.$sections.css({"padding-top":f,"padding-bottom":f}))},a.prototype.checkHash=function(){var a,b;return a=window.location.hash,(b=a.substr(2))?this.go(b):void 0},a.prototype.highlight=function(){return hljs.initHighlightingOnLoad()},a.prototype.first=function(){return this.firstSlide()},a.prototype.firstSlide=function(){return this.go(this.getFirstSlide(),{direction:"backward"})},a.prototype.getFirstSlide=function(){return this.$sections.first()},a.prototype.isFirstSlide=function(){return this.$current.is(this.getFirstSlide())},a.prototype.prev=function(){return this.hasSteps()?this.prevStep():this.prevSlide()},a.prototype.prevSlide=function(){var a;return a=this.$current.prev("section"),this.go(a,{direction:"backward"})},a.prototype.prevStep=function(){var a;return this.$steps.eq(this.index).removeClass("step").fadeOut(),a=this.$steps.eq(--this.index),this.index<-1?this.prevSlide():a.is(":visible")?a.addClass("step").trigger("step"):this.index>-1?this.prevStep():void 0},a.prototype.last=function(){return this.lastSlide()},a.prototype.lastSlide=function(){return this.go(this.getLastSlide(),{direction:"forward"})},a.prototype.getLastSlide=function(){return this.$sections.last()},a.prototype.isLastSlide=function(){return this.$current.is(this.getLastSlide())},a.prototype.isLastStep=function(){return!this.hasSteps()||this.index===this.$steps.length-1},a.prototype.next=function(){return this.hasSteps()?this.nextStep():this.nextSlide()},a.prototype.nextSlide=function(){var a;return a=this.$current.next("section"),this.go(a,{direction:"forward"})},a.prototype.nextStep=function(){var a;return this.$steps.eq(this.index).removeClass("step"),a=this.$steps.eq(++this.index),a.length?a.fadeIn().addClass("step").trigger("step"):this.nextSlide()},a.prototype.checkSteps=function(a,b){return this.$steps=a.find(".steps").children(),this.$steps.length||(this.$steps=a.find(".step")),"backward"===b?this.index=this.$steps.length-1:(this.index=-1,this.$steps.hide())},a.prototype.hasSteps=function(){return null!=this.$steps&&0!==this.$steps.length},a.prototype.find=function(a){var b;return a instanceof $?a:(b=$("#"+a),0===b.length&&(b=this.$sections.eq(parseInt(a)-1)),b)},a.prototype.go=function(a,b){var c;return null==a&&(a=1),null==b&&(b={}),c=this.find(a),!c.length||!b.force&&c.is(this.$current)?void 0:(this.checkSteps(c,b.direction),this.navigate(c),this.translate(c),this.current(c),this.pagination())},a.prototype.navigate=function(a){return window.location.hash="/"+(a.attr("id")||a.index()+1)},a.prototype.translate=function(a){var b;return b=a.prevAll().map(function(){return $(this).outerHeight()}).get().reduce(function(a,b){return a+b},0),this.$ruban.css("transform","translateY(-"+b+"px)")},a.prototype.current=function(a){var b;return b=this.$current,this.$current=a,null!=b&&b.removeClass("active").trigger("inactive"),this.$current.addClass("active").trigger("active")},a.prototype.pagination=function(){return this.paginationText=[],this.options.title&&this.paginationText.push(this.options.title),this.options.pagination||this.options.title?(this.$pagination||(this.$ruban.parent().append('<footer class="pagination"></footer>'),this.$pagination=$(".pagination"),this.total=this.$sections.length),this.options.pagination&&this.paginationText.push(""+(this.$current.index()+1)+"/"+this.total),this.$pagination.html(this.paginationText.join(" - "))):void 0},a.prototype.toc=function(){var a,b,c;return a=$(".toc").first(),a.length?(c=this.options.stripHtmlInToc,b=$("<ul/>"),$("section:not(.no-toc,.toc) > h1:only-child").each(function(){var a,d,e,f;return d=$(this).parent(),c?f=e=$(this).text():(a=$(this).clone().find("a").replaceWith(function(){return $(this).text()}).end(),f=a.text(),e=a.html()),$("<li/>").append($("<a/>",{href:"#/"+(d.attr("id")||d.index()+1),title:f,html:e})).appendTo(b)}),a.append(b)):void 0},a}(),window.Ruban=a}).call(this);